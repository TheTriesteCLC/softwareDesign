<div id="map"></div>

<button id="my-loc">Find my location</button>
{{!-- <button id="center-loc">Mark center</button> --}}

<!-- leaflet js  -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.74.0/dist/L.Control.Locate.min.js" charset="utf-8"></script>


<script>
    // Map initialization 
    var map = L.map('map').setView([10.762622, 106.660172], 12);

    //osm layer
    var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });
    osm.addTo(map);

    //L.control.locate().addTo(map);

    L.DomEvent.on(document.getElementById('my-loc'), 'click', function(){
        map.locate({setView: true, maxZoom: 16});
    })

    const currentLocIcon = L.icon({
        iconUrl: 'https://img.icons8.com/fluency/48/map-pin.png',

        iconSize:     [50, 50], // size of the icon
        iconAnchor:   [25, 50], // point of the icon which will correspond to marker's location
        popupAnchor:  [0, -50] // point from which the popup should open relative to the iconAnchor
    });
    const destinationLocIcon = L.icon({
        iconUrl: 'https://img.icons8.com/ultraviolet/40/filled-flag2.png',

        iconSize:     [40, 40], // size of the icon
        iconAnchor:   [5, 45], // point of the icon which will correspond to marker's location
    });

    var currentLatlong;
    var centerMarker = new L.marker(map.getCenter(), {icon: destinationLocIcon}).addTo(map);

    function onLocationFound(e) {
        var radius = e.accuracy;

        var currentMarker = L.marker(e.latlng, {icon: currentLocIcon}).addTo(map)
            .bindPopup("You are here").openPopup();

        currentLatlong = currentMarker._latlng;
        //L.circle(e.latlng, radius).addTo(map);
    }

    map.on("move", function () {
        centerMarker.setLatLng(map.getCenter());
    });

    map.on('locationfound', onLocationFound);

    function markCenter(e) {
        var currentMarker = L.marker(map.getCenter()).addTo(map);
    }

    document.getElementById('center-loc').addEventListener("click",markCenter);
</script>